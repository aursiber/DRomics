<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Computation of confidence interval on benchmark doses by bootstrap — bmdboot • DRomics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Computation of confidence interval on benchmark doses by bootstrap — bmdboot"><meta property="og:description" content="Computes  95 percent confidence intervals on x-fold and z-SD benchmark doses by bootstrap."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DRomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/DRomics_vignette.html">Overview of the DRomics package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/aursiber/DRomics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Computation of confidence interval on benchmark doses by bootstrap</h1>
    
    <div class="hidden name"><code>bmdboot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes  95 percent confidence intervals on x-fold and z-SD benchmark doses by bootstrap.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, items <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">id</span>, niter <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                    conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>                    tol <span class="op">=</span> <span class="fl">0.5</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    parallel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"snow"</span>, <span class="st">"multicore"</span><span class="op">)</span>, <span class="va">ncpus</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for bmdboot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for bmdboot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, BMDtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zSD"</span>, <span class="st">"xfold"</span><span class="op">)</span>, remove.infinite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"trend"</span>, <span class="st">"model"</span>, <span class="st">"typology"</span><span class="op">)</span>, CI.col <span class="op">=</span> <span class="st">"blue"</span>,  <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>r</dt>
<dd><p>An object of class <code>"bmdcalc"</code> returned by the function <code>bmdcalc</code>.</p></dd>


<dt>items</dt>
<dd><p>A character vector specifying the identifiers of the items for which you want the
computation of confidence intervals. 
If omitted the computation is done for all the items.</p></dd>


<dt>niter</dt>
<dd><p>The number of samples drawn by bootstrap.</p></dd>


<dt>conf.level</dt>
<dd><p>Confidence level of the intervals.</p></dd>


<dt>tol</dt>
<dd><p>The tolerance in term of proportion of bootstrap samples
on which the fit of the model is successful (if this proportion is below the tolerance,
NA values are given for the limits of the confidence interval.</p></dd>


<dt>progressbar</dt>
<dd><p>If <code>TRUE</code> a progress bar is used to follow the bootstrap process.</p></dd>


<dt>parallel</dt>
<dd><p>The type of parallel operation to be used, <code>"snow"</code> or <code>"multicore"</code>
  (the second one not being available on Windows),
  or <code>"no"</code> if no parallel operation.</p></dd>

  
<dt>ncpus</dt>
<dd><p>Number of processes to be used in parallel operation : 
  typically one would fix it to the number of available CPUs.</p></dd>


<dt>x</dt>
<dd><p>An object of class <code>"bmdboot"</code>.</p></dd>


<dt>BMDtype</dt>
<dd><p>The type of BMD to plot, <code>"zSD"</code> (default choice) or <code>"xfold"</code>.</p></dd>


<dt>remove.infinite</dt>
<dd><p>If TRUE the confidence intervals with non finite upper bound are not plotted.</p></dd>


<dt>by</dt>
<dd><p>If not at <code>"none"</code> the plot is split by the indicated factor (<code>"trend"</code>,
  <code>"model"</code> or <code>"typology"</code>).</p></dd>

  
<dt>CI.col</dt>
<dd><p>The color to draw the confidence intervals.</p></dd>



<dt>...</dt>
<dd><p>Further arguments passed to graphical or print functions.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>Non-parametric bootstrapping is used, where mean centered residuals are bootstrapped. 
For each item, bootstrapped parameter estimates are obtained by fitting the model on each of the resampled data sets. If the fitting procedure fails to converge in more than tol*100% of the cases, NA values are given for the confidence interval. Otherwise, bootstraped
BMD are computed from bootstrapped parameter estimates using the same method as 
in <code><a href="bmdcalc.html">bmdcalc</a></code>.
Confidence intervals on BMD are then
computed using percentiles of the bootstrapped BMDs.
For example 95 percent confidence intervals are 
computed using 2.5 and 97.5 percentiles of the bootstrapped BMDs. 
In cases where the bootstrapped BMD cannot be estimated as
not reached at the highest tested dose or not reachable due to model asymptotes,
it was given an infinite value <code>Inf</code>, so as to enable the computation
of the lower limit of the BMD confidence interval if a sufficient number of bootstrapped BMD values were estimated
to finite values.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p></p>
<p><code>bmdboot</code> returns an object of class <code>"bmdboot"</code>, a list with 3 components:</p>
<dl><dt>res</dt>
<dd><p>a data frame reporting the results of the fit, BMD computation and bootstrap
   on each specified item sorted in the ascending order of the adjusted p-values. The different columns correspond to 
   the identifier of each item (<code>id</code>), the row number of this item in the initial data set (<code>irow</code>), 
   the adjusted p-value of the selection step (<code>adjpvalue</code>), the name of the best fit model (<code>model</code>), 
   the number of fitted parameters (<code>nbpar</code>), the values of the parameters <code>b</code>, <code>c</code>, <code>d</code>, 
   <code>e</code> and <code>f</code>, (<code>NA</code> for non used parameters), the residual standard deviation (<code>SDres</code>), 
   the typology of the curve (<code>typology</code>, (16 class typology described in the help of the <code>drcfit</code> 
   function)), the rough trend of the curve (<code>trend</code>) defined with four classes 
   (U, bell, increasing or decreasing shape), the theoretical value at the control (<code>y0</code>), 
   the theoretical y range for x within the range of tested doses 
   (<code>yrange</code>), the maximal absolute y change (up or down) from the control(<code>maxychange</code>) 
   and for biphasic curves 
   the x value at which their extremum is reached (<code>xextrem</code>)
   and the corresponding y value (<code>yextrem</code>), the BMD-zSD value (<code>BMD.zSD</code>)
   with the corresponding BMR-zSD value (reached or not, <code>BMR.zSD</code>) and 
   the BMD-xfold value (<code>BMD.xfold</code>)
   with the corresponding BMR-xfold value (reached or not, <code>BMR.xfold</code>), 
   <code>BMD.zSD.lower</code> and  <code>BMD.zSD.upper</code> the lower and upper bounds of the 
   confidence intervals of the BMD-zSD value, 
   <code>BMD.xfold.lower</code> and  <code>BMD.xfold.upper</code> the lower and upper bounds of the
   confidence intervals of the BMD-xfold value and
   <code>nboot.successful</code> the number of successful fits on bootstrapped samples for each item.</p></dd>


  <dt>z</dt>
<dd><p>Value of z given in input to define the BMD-zSD.</p></dd>


  <dt>x</dt>
<dd><p>Value of x given in input as a percentage to define the BMD-xfold.</p></dd>


  <dt>tol</dt>
<dd><p>The tolerance given in input in term of tolerated proportion of failures of
  fit on bootstrapped samples.</p></dd>


  <dt>niter</dt>
<dd><p>The number of samples drawn by bootstrap (given in input).</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="bmdcalc.html">bmdcalc</a></code> for details about the computation of benchmark doses.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Huet S, Bouvier A, Poursat M-A, Jolivet E (2003) Statistical tools for nonlinear regression: a practical guide with S-PLUS and R examples. Springer, Berlin, Heidelberg, New York.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Marie-Laure Delignette-Muller</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># (1) a toy example (a very small subsample of a microarray data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_very_small_sample.txt"</span>,</span></span>
<span class="r-in"><span>   package <span class="op">=</span> <span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to test the package on a small but not very small data set</span></span></span>
<span class="r-in"><span><span class="co"># use the following commented line</span></span></span>
<span class="r-in"><span><span class="co"># datafilename &lt;- system.file("extdata", "transcripto_sample.txt", package = "DRomics")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-in"><span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> <span class="co"># to get reproducible results with a so small number of iterations</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># with a non reasonable value for niter </span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> A small number of iterations (less than 1000) may not be sufficient to</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> ensure a good quality of bootstrap confidence intervals.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap confidence interval computation was successful on 10 items among10.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For 0 BMD.zSD values and 4 BMD.xfold values among 10 at least one bound </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of the 95 percent confidence interval could not be computed due to some </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrapped BMD values not reachable due to model asymptotes or </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reached outside the range of tested doses (bounds coded Inf)).</span>
<span class="r-in"><span><span class="co"># !!!! TO GET CORRECT RESULTS</span></span></span>
<span class="r-in"><span><span class="co"># !!!! niter SHOULD BE FIXED FAR LARGER , e.g. to 1000 </span></span></span>
<span class="r-in"><span><span class="co"># !!!! but the run will be longer </span></span></span>
<span class="r-in"><span><span class="va">b</span><span class="op">$</span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      id irow    adjpvalue        model nbpar            b          c          d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    15   15 1.546048e-05  exponential     3  0.071422066         NA   7.740153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  12.1   12 2.869315e-05 Gauss-probit     5  0.414151041   8.903415   7.564374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  27.1   27 3.087292e-05       linear     2 -0.108446801         NA  15.608419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  25.1   25 1.597308e-04  exponential     3 -0.128807292         NA  15.142111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     4    4 2.302448e-04 Gauss-probit     4  3.079187326   9.851210   9.851210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    70   70 2.323292e-04  exponential     3 -0.007515178         NA   6.682254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   7.1    7 2.712029e-04 Gauss-probit     4  2.384260609   9.122630   9.122630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  88.1   88 4.566344e-04 Gauss-probit     4  2.103260561  11.157946  11.157946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    92   92 4.566344e-04 Gauss-probit     4  8.383265326 -27.815887 -27.815887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   81   81 6.448977e-04  exponential     3 -0.025717022         NA   6.713592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           e          f     SDres      typology trend        y0    yrange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2.276374         NA 0.3183292  E.inc.convex   inc  7.740153 1.2435536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1.131878  0.7204104 0.3802228       GP.bell  bell  7.585780 1.5579862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        NA         NA 0.1648041         L.dec   dec 15.608419 0.7191107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  3.404152         NA 0.2142472 E.dec.concave   dec 15.142111 0.7746535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1.959459 -1.6121598 0.2994936          GP.U     U  8.534547 1.1021236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1.074079         NA 1.1263294 E.dec.concave   dec  6.682254 3.5993190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1.735801 -0.9436036 0.2594717          GP.U     U  8.398699 0.8289366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1.755034  0.7172904 0.2131311       GP.bell  bell 11.664353 0.6684651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2.557102 37.5435184 1.1492863       GP.bell  bell  8.021108 4.1812979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1.357554         NA 1.1925115 E.dec.concave   dec  6.713592 3.3747642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    maxychange  xextrem   yextrem   BMD.zSD   BMR.zSD BMD.xfold BMR.xfold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1.2435536       NA        NA 3.8627823  8.058482 5.6254817  8.514168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1.5579862 1.438980  9.143766 0.5682965  7.966002 0.7867277  8.344358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   0.7191107       NA        NA 1.5196769 15.443615        NA 14.047577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.7746535       NA        NA 3.3346117 14.927864        NA 13.627900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   0.8066265 1.959459  8.239050 4.9146814  8.834040        NA  9.388001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   3.5993190       NA        NA 5.3880583  5.555925 4.8321577  6.014029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   0.6092640 1.735801  8.179027 4.5746396  8.658171        NA  9.238569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   0.4575814 1.755034 11.875236 4.5680107 11.451221        NA 10.497917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   2.4747750 2.557102  9.727631 1.1073090  9.170394 0.7057627  8.823219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  3.3747642       NA        NA 5.2374444  5.521081 4.4795785  6.042233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    BMD.zSD.lower BMD.zSD.upper BMD.xfold.lower BMD.xfold.upper nboot.successful</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      2.5419717     5.4286702       5.2096774       6.3162978                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0.3962742     0.6113321       0.7585065       0.8436521                3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1.2880859     1.8703357             Inf             Inf                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1.7779682     4.3860449             Inf             Inf                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0.8764841     4.6482204       6.2736051       6.5002418                3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      5.5427841     5.8066250       4.8002541       5.2521977                3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      0.8306628     5.0191980             Inf             Inf                4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      0.8761456     1.3426847             Inf             Inf                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      0.6833652     1.7755852       0.5927668       0.9811839                3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     4.3970397     5.6776346       3.2853537       5.1984022                4</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="co"># plot of BMD.zSD after removing of BMDs with infinite upper bounds</span></span></span>
<span class="r-plt img"><img src="bmdboot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, remove.infinite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># plot of BMD.zSD without removing of BMDs </span></span></span>
<span class="r-plt img"><img src="bmdboot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>                                 <span class="co"># with infinite upper bounds</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># bootstrap on only a subsample of items</span></span></span>
<span class="r-in"><span><span class="co"># with a greater number of iterations</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">chosenitems</span> <span class="op">&lt;-</span> <span class="va">r</span><span class="op">$</span><span class="va">res</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> </span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">b.95</span> <span class="op">&lt;-</span> <span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, items <span class="op">=</span> <span class="va">chosenitems</span>,</span></span>
<span class="r-in"><span>                     niter <span class="op">=</span> <span class="fl">1000</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap confidence interval computation was successful on 5 items among5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For 0 BMD.zSD values and 3 BMD.xfold values among 5 at least one bound </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of the 95 percent confidence interval could not be computed due to some </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrapped BMD values not reachable due to model asymptotes or </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reached outside the range of tested doses (bounds coded Inf)).</span>
<span class="r-in"><span><span class="va">b.95</span><span class="op">$</span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id irow    adjpvalue        model nbpar           b        c         d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   15   15 1.546048e-05  exponential     3  0.07142207       NA  7.740153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 12.1   12 2.869315e-05 Gauss-probit     5  0.41415104 8.903415  7.564374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 27.1   27 3.087292e-05       linear     2 -0.10844680       NA 15.608419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 25.1   25 1.597308e-04  exponential     3 -0.12880729       NA 15.142111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4    4 2.302448e-04 Gauss-probit     4  3.07918733 9.851210  9.851210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          e          f     SDres      typology trend        y0    yrange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.276374         NA 0.3183292  E.inc.convex   inc  7.740153 1.2435536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.131878  0.7204104 0.3802228       GP.bell  bell  7.585780 1.5579862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA         NA 0.1648041         L.dec   dec 15.608419 0.7191107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.404152         NA 0.2142472 E.dec.concave   dec 15.142111 0.7746535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.959459 -1.6121598 0.2994936          GP.U     U  8.534547 1.1021236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   maxychange  xextrem  yextrem   BMD.zSD   BMR.zSD BMD.xfold BMR.xfold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1.2435536       NA       NA 3.8627823  8.058482 5.6254817  8.514168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1.5579862 1.438980 9.143766 0.5682965  7.966002 0.7867277  8.344358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.7191107       NA       NA 1.5196769 15.443615        NA 14.047577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.7746535       NA       NA 3.3346117 14.927864        NA 13.627900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.8066265 1.959459 8.239050 4.9146814  8.834040        NA  9.388001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BMD.zSD.lower BMD.zSD.upper BMD.xfold.lower BMD.xfold.upper nboot.successful</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1.9227727     5.3310326       4.2858846        6.300160              927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0.2455283     0.8147277       0.5075138        1.061894              567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.9228184     2.1008927             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1.5797142     5.0442655             Inf             Inf              928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.5446872     5.1796377       5.7928430             Inf              747</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot of fits with BMD values  and confidence intervals</span></span></span>
<span class="r-in"><span><span class="co"># with the default BMD.zSD</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, items <span class="op">=</span> <span class="va">chosenitems</span>, BMDoutput <span class="op">=</span> <span class="va">b.95</span>, BMDtype <span class="op">=</span> <span class="st">"zSD"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="bmdboot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># with the default BMD.xfold </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span>, items <span class="op">=</span> <span class="va">chosenitems</span>, BMDoutput <span class="op">=</span> <span class="va">b.95</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 3 rows containing missing values (`geom_vline()`).</span>
<span class="r-plt img"><img src="bmdboot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same bootstrap but changing the default confidence level (0.95) to 0.90</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">b.90</span> <span class="op">&lt;-</span> <span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, items <span class="op">=</span> <span class="va">chosenitems</span>,</span></span>
<span class="r-in"><span>                       niter <span class="op">=</span> <span class="fl">1000</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%  |                                                                              |============================                                          |  40%  |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap confidence interval computation was successful on 5 items among5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For 0 BMD.zSD values and 3 BMD.xfold values among 5 at least one bound </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> of the 95 percent confidence interval could not be computed due to some </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrapped BMD values not reachable due to model asymptotes or </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reached outside the range of tested doses (bounds coded Inf)).</span>
<span class="r-in"><span><span class="va">b.90</span><span class="op">$</span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id irow    adjpvalue        model nbpar           b        c         d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   15   15 1.546048e-05  exponential     3  0.07142207       NA  7.740153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 12.1   12 2.869315e-05 Gauss-probit     5  0.41415104 8.903415  7.564374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 27.1   27 3.087292e-05       linear     2 -0.10844680       NA 15.608419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 25.1   25 1.597308e-04  exponential     3 -0.12880729       NA 15.142111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4    4 2.302448e-04 Gauss-probit     4  3.07918733 9.851210  9.851210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          e          f     SDres      typology trend        y0    yrange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.276374         NA 0.3183292  E.inc.convex   inc  7.740153 1.2435536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.131878  0.7204104 0.3802228       GP.bell  bell  7.585780 1.5579862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       NA         NA 0.1648041         L.dec   dec 15.608419 0.7191107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 3.404152         NA 0.2142472 E.dec.concave   dec 15.142111 0.7746535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.959459 -1.6121598 0.2994936          GP.U     U  8.534547 1.1021236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   maxychange  xextrem  yextrem   BMD.zSD   BMR.zSD BMD.xfold BMR.xfold</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1.2435536       NA       NA 3.8627823  8.058482 5.6254817  8.514168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1.5579862 1.438980 9.143766 0.5682965  7.966002 0.7867277  8.344358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.7191107       NA       NA 1.5196769 15.443615        NA 14.047577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.7746535       NA       NA 3.3346117 14.927864        NA 13.627900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.8066265 1.959459 8.239050 4.9146814  8.834040        NA  9.388001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BMD.zSD.lower BMD.zSD.upper BMD.xfold.lower BMD.xfold.upper nboot.successful</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     2.1866560     5.1203351       4.5223195        6.214326              940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     0.2859876     0.7638092       0.5877853        1.025521              581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     0.9791835     2.0226321             Inf             Inf             1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1.8393747     4.8993172             Inf             Inf              948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     0.6370940     4.9971094       5.9396072             Inf              768</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (2) an example on a microarray data set (a subsample of a greater data set) </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">datafilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"transcripto_sample.txt"</span>, package<span class="op">=</span><span class="st">"DRomics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="microarraydata.html">microarraydata</a></span><span class="op">(</span><span class="va">datafilename</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, norm.method <span class="op">=</span> <span class="st">"cyclicloess"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Just wait, the normalization using cyclicloess may take a few minutes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elements of the experimental design in order to check the coding of the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tested doses and number of replicates for each dose:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  0.69 1.223 2.148 3.774 6.631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5     5     5     5     5     5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of items: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "1"    "2"    "3"    "4"    "5.1"  "5.2"  "6.1"  "6.2"  "7.1"  "7.2" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "8.1"  "8.2"  "9.1"  "9.2"  "10.1" "10.2" "11.1" "11.2" "12.1" "12.2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data were normalized between arrays using the following method: cyclicloess </span>
<span class="r-in"><span><span class="op">(</span><span class="va">s_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="itemselect.html">itemselect</a></span><span class="op">(</span><span class="va">o</span>, select.method <span class="op">=</span> <span class="st">"quadratic"</span>, FDR <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removing intercept from test coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of selected items using a quadratic trend test with an FDR of 0.001: 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Identifiers of the first 20 most responsive items:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "384.2" "383.1" "383.2" "384.1" "301.1" "363.1" "300.2" "364.2" "364.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "363.2" "301.2" "300.1" "351.1" "350.2" "239.1" "240.1" "240.2" "370"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "15"    "350.1"</span>
<span class="r-in"><span><span class="op">(</span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="drcfit.html">drcfit</a></span><span class="op">(</span><span class="va">s_quad</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The fitting may be long if the number of selected items is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  92%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of the fitting using the AICc to select the best fit model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 dose-response curves out of 78 previously selected were removed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> because no model could be fitted reliably.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the chosen models among the 67 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Hill           linear      exponential     Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                0               11               30               24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log-Gauss-probit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution of the trends (curve shapes) among the 67 fitted dose-response curves:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    U bell  dec  inc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6   20   22   19 </span>
<span class="r-in"><span><span class="op">(</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmdcalc.html">bmdcalc</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 BMD-xfold values and 0 BMD-zSD values are not defined (coded NaN as </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> the BMR stands outside the range of response values defined by the model).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 BMD-xfold values and 0 BMD-zSD values could not be calculated (coded </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA as the BMR stands within the range of response values defined by the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model but outside the range of tested doses).</span>
<span class="r-in"><span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="co"># niter to put at 1000 for a better precision</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> A small number of iterations (less than 1000) may not be sufficient to</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> ensure a good quality of bootstrap confidence intervals.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The bootstrap may be long if the number of items and the number of </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrap iterations is high.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  19%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |===========================================                           |  61%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |============================================================          |  85%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrap confidence interval computation failed on 6 items among 67 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> due to lack of convergence of the model fit for a fraction of the </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bootstrapped samples greater than 0.5.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For 0 BMD.zSD values and 35 BMD.xfold values among 67 at least one </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bound of the 95 percent confidence interval could not be computed due </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> to some bootstrapped BMD values not reachable due to model asymptotes </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> or reached outside the range of tested doses (bounds coded Inf)).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># different plots of BMD-zSD</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 6 BMD values for which lower and upper bounds were coded NA or with</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> lower or upper infinite bounds were removed before plotting.</span>
<span class="r-plt img"><img src="bmdboot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># in BMD log10 scale</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 6 BMD values for which lower and upper bounds were coded NA or with</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> lower or upper infinite bounds were removed before plotting.</span>
<span class="r-plt img"><img src="bmdboot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, by <span class="op">=</span> <span class="st">"trend"</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 6 BMD values for which lower and upper bounds were coded NA or with</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> lower or upper infinite bounds were removed before plotting.</span>
<span class="r-plt img"><img src="bmdboot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, by <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 6 BMD values for which lower and upper bounds were coded NA or with</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> lower or upper infinite bounds were removed before plotting.</span>
<span class="r-plt img"><img src="bmdboot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, by <span class="op">=</span> <span class="st">"typology"</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 6 BMD values for which lower and upper bounds were coded NA or with</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> lower or upper infinite bounds were removed before plotting.</span>
<span class="r-plt img"><img src="bmdboot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a plot of BMD-xfold (by default BMD-zSD is plotted)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, BMDtype <span class="op">=</span> <span class="st">"xfold"</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 41 BMD values for which lower and upper bounds were coded NA or with</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> lower or upper infinite bounds were removed before plotting.</span>
<span class="r-plt img"><img src="bmdboot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># (3) Comparison of parallel and non parallel implementations </span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># to be tested with a greater number of iterations</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"parallel"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="kw">if</span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">100</span>, progressbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu">bmdboot</span><span class="op">(</span><span class="va">r</span>, niter <span class="op">=</span> <span class="fl">100</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span>, parallel <span class="op">=</span> <span class="st">"snow"</span>, ncpus <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marie-Laure Delignette-Muller, Elise Billoir, Aurelie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

